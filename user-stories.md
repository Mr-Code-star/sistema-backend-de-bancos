### EPICS

| Epic ID | Epic                                     |
| ------- | ---------------------------------------- |
| EP-01   | Gestión de Identidad y Seguridad (IAM)   |
| EP-02   | Gestión de Perfil del Cliente            |
| EP-03   | Gestión de Cuentas Bancarias             |
| EP-04   | Transferencias Bancarias                 |
| EP-05   | Pagos a Servicios (Payments & Merchants) |
| EP-06   | Registro Contable (Ledger)               |
| EP-07   | Estados de Cuenta y Reportes             |
| EP-08   | Notificaciones al Usuario                |
| EP-09   | Control de Límites Operativos            |
| EP-10   | Administración y Compliance              |


### User Stories

#### IAM


| ID | Título                     | Descripción                                                         | Criterio de Aceptación                                                                                                                                                     | Relación (Epic ID) |
| ------------------ | -------------------------- | ------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------ |
| **US-IAM-01** | API RESTful – Registro de usuario                  | Como usuario quiero registrarme en la plataforma para poder acceder al sistema bancario.     | **Escenario: Registro de usuario**.<br>**Cuando** envío `POST /api/v1/iam/auth/register` con<br>`json`<br>{<br> "email": "[user@mail.com](mailto:user@mail.com)",<br> "password": "Password123!"<br>}<br>**Entonces** el sistema valida los datos, registra al usuario y devuelve `201 Created` con<br>`json`<br>{<br> "userId": "uuid",<br> "email": "[user@mail.com](mailto:user@mail.com)",<br> "status": "ACTIVE"<br>} | EP-01 |
| **US-IAM-02** | API RESTful – Login de usuario                     | Como usuario quiero autenticarme para obtener un token JWT y acceder a endpoints protegidos. | **Escenario: Login exitoso**.<br>**Cuando** envío `POST /api/v1/iam/auth/login` con<br>`json`<br>{<br> "email": "[user@mail.com](mailto:user@mail.com)",<br> "password": "Password123!"<br>}<br>**Entonces** el sistema valida las credenciales y devuelve `200 OK` con<br>`json`<br>{<br> "userId": "uuid",<br> "email": "[user@mail.com](mailto:user@mail.com)",<br> "token": "jwt-token"<br>}                           | EP-01 |
| **US-IAM-03** | API RESTful – Login con MFA                        | Como usuario quiero autenticarme usando MFA para aumentar la seguridad de mi cuenta.         | **Escenario: Login con MFA**.<br>**Dado que** el usuario tiene MFA habilitado.<br>**Cuando** envío `POST /api/v1/iam/auth/login` con<br>`json`<br>{<br> "email": "[user@mail.com](mailto:user@mail.com)",<br> "password": "Password123!",<br> "mfaCode": "123456"<br>}<br>**Entonces** el sistema valida el código MFA y devuelve `200 OK` con un token JWT válido.                                                        | EP-01 |
| **US-IAM-04** | API RESTful – Solicitar recuperación de contraseña | Como usuario quiero solicitar la recuperación de mi contraseña mediante correo electrónico.  | **Escenario: Solicitud de recuperación**.<br>**Cuando** envío `POST /api/v1/iam/password-recovery/request` con<br>`json`<br>{<br> "email": "[user@mail.com](mailto:user@mail.com)"<br>}<br>**Entonces** el sistema responde `200 OK` y, si el usuario existe, envía un correo con un enlace de recuperación.                                                                                                               | EP-01 |
| **US-IAM-05** | API RESTful – Restablecer contraseña               | Como usuario quiero cambiar mi contraseña usando un token de recuperación.                   | **Escenario: Reset de contraseña**.<br>**Dado que** el usuario posee un token válido.<br>**Cuando** envío `POST /api/v1/iam/password-recovery/reset` con<br>`json`<br>{<br> "token": "reset-token",<br> "newPassword": "NewPassword123!"<br>}<br>**Entonces** el sistema actualiza la contraseña y devuelve `200 OK` con<br>`json`<br>{<br> "message": "Password updated"<br>}                                             | EP-01 |
| **US-IAM-06** | API RESTful – Verificar MFA                        | Como usuario quiero verificar mi método MFA para activarlo.                                  | **Escenario: Verificación MFA**.<br>**Cuando** envío `POST /api/v1/iam/users/{id}/verify-mfa` con<br>`json`<br>{<br> "methodId": "uuid",<br> "code": "123456"<br>}<br>**Entonces** el sistema valida el código y devuelve `200 OK`.                                                                                                                                                                                     | EP-01 |
| **US-IAM-07** | API RESTful – Registrar método MFA para usuario | Como usuario quiero registrar un método de autenticación multifactor para proteger mi cuenta con un segundo factor de seguridad. | **Escenario: Registro de método MFA**.<br>**Dado que** el usuario está autenticado.<br>**Cuando** envío `POST /api/v1/iam/users/{id}/mfa-methods` con<br>`json`<br>{<br> "type": "AUTH_APP",<br> "destination": "user@auth-app"<br>}<br>**Entonces** el sistema registra el método MFA en estado no verificado y devuelve `201 Created` con<br>`json`<br>{<br> "methodId": "uuid",<br> "type": "AUTH_APP",<br> "verified": false<br>} | EP-01 |

### Profiles

| ID | Título                     | Descripción                                                         | Criterio de Aceptación                                                                                                                                                     | Relación (Epic ID) |
| ------------------ | -------------------------- | ------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------ |
| **US-PRF-01** | API RESTful – Crear perfil del cliente                | Como usuario autenticado quiero crear mi perfil con mis datos personales para completar mi registro como cliente bancario. | **Escenario: Creación de perfil**.<br>**Cuando** envío `POST /api/v1/profiles` con<br>`json`<br>{<br> "givenNames": "Chester", <br> "paternalSurname": "Bennighton", <br> "maternalSurname": "Charles", <br> "phoneNumber": "+51994755649", <br> "documentType": "DNI", <br> "documentNumber": "40146880" <br>}<br> **Entonces** el sistema crea el perfil asociado al usuario autenticado y devuelve `201 Created` con<br>`json`<br>{<br> "profileId": "uuid",<br> "userId": "uuid",<br> "givenames": "Chester"<br> .... <br>} | EP-02 |
| **US-PRF-02** | API RESTful – Consultar mi perfil                     | Como usuario quiero consultar mi perfil para visualizar mis datos personales registrados.                                  | **Escenario: Consulta de perfil propio**.<br>**Cuando** envío `GET /api/v1/profiles/me`<br>**Entonces** el sistema devuelve `200 OK` con<br>`json`<br>{<br> "profileId": "uuid", "userId"<br> "givenNames": "Juan Pérez",<br> "addresses": [ ... ],<br> "phoneNumber":  ... <br> ... <br>}                                                                                                                                                                   | EP-02 |
| **US-PRF-03** | API RESTful – Consultar perfil por ID                 | Como sistema quiero consultar un perfil por su identificador para validaciones internas o administrativas.                 | **Escenario: Consulta de perfil por ID**.<br>**Cuando** envío `GET /api/v1/profiles/{profileId}`<br>**Entonces** el sistema devuelve `200 OK` con la información del perfil correspondiente.                                                                                                                                                                                                                                               | EP-02 |
| **US-PRF-04** | API RESTful – Actualizar perfil                       | Como usuario quiero actualizar la información de mi perfil para mantener mis datos correctos.                              | **Escenario: Actualización de perfil**.<br>**Cuando** envío `PUT /api/v1/profiles/{profileId}` con<br>`json`<br>{<br> "givenNames": "Juan Pérez Gómez",<br> "phoneNumber": "+51911112222"<br> ... <br>}<br>**Entonces** el sistema actualiza el perfil y devuelve `200 OK` con los datos modificados.                                                                                                                                                 | EP-02 |
| **US-PRF-05** | API RESTful – Registrar dirección                     | Como usuario quiero registrar una dirección en mi perfil para completar mi información personal.                           | **Escenario: Registro de dirección**.<br>**Cuando** envío `POST /api/v1/profiles/{profileId}/addresses` con<br>`json`<br>{<br> "type": "BILLING", <br> "line1": "LIMA", <br> "line2": "LURIN", <br> "city": "LURIN", <br> "region": "LURIN", <br> "country": "PERU", <br> "postalCode": "123123", <br> "makePrimary": true<br>}<br>**Entonces** el sistema registra la dirección y devuelve `201 Created` con<br>`json`<br>{<br> "addressId": "uuid",<br> "primary": false<br>...<br>}| EP-02 |
| **US-PRF-06** | API RESTful – Actualizar dirección                    | Como usuario quiero actualizar una dirección registrada en mi perfil.                                                      | **Escenario: Actualización de dirección**.<br>**Cuando** envío `PUT /api/v1/profiles/{profileId}/addresses/{addressId}` con<br>`json`<br>{<br> "type": "string", <br> "line1": "string", <br> "line2": "string", <br> "city": "string",<br> "region": "string", <br> "country": "string", <br> "postalCode": "string"<br>}<br>**Entonces** el sistema actualiza la dirección y devuelve `200 OK`. | EP-02 |
| **US-PRF-07** | API RESTful – Eliminar dirección                      | Como usuario quiero eliminar una dirección que ya no utilizo.                                                              | **Escenario: Eliminación de dirección**.<br>**Cuando** envío `DELETE /api/v1/profiles/{profileId}/addresses/{addressId}`<br>**Entonces** el sistema elimina la dirección y devuelve `204 No Content`.                                                                                                                                                                                                                                      | EP-02 |
| **US-PRF-08** | API RESTful – Marcar dirección como principal         | Como usuario quiero marcar una dirección como principal para que sea la dirección por defecto de mi perfil.                | **Escenario: Dirección principal**.<br>**Cuando** envío `PUT /api/v1/profiles/{profileId}/addresses/{addressId}/primary`<br>**Entonces** el sistema marca la dirección como principal y devuelve `200 OK`.                                                                                                                                                                                                                                 | EP-02 |
| **US-PRF-09** | API RESTful – Consultar preferencias de notificación  | Como usuario quiero consultar mis preferencias de notificación para saber cómo recibo alertas.                             | **Escenario: Consulta de preferencias**.<br>**Cuando** envío `GET /api/v1/profiles/me/preferences/notifications`<br>**Entonces** el sistema devuelve `200 OK` con<br>`json`<br>{<br> "TRANSFER": ["IN_APP", "EMAIL"],<br> "PAYMENT": ["IN_APP"]<br>}                                                                                                                                                                                       | EP-02 |
| **US-PRF-10** | API RESTful – Actualizar preferencias de notificación | Como usuario quiero actualizar mis preferencias de notificación para personalizar cómo recibo mensajes.                    | **Escenario: Actualización de preferencias**.<br>**Cuando** envío `PUT /api/v1/profiles/me/preferences/notifications` con<br>`json`<br>{<br> "TRANSFER": ["IN_APP"],<br> "PAYMENT": ["IN_APP", "SMS"]<br>}<br>**Entonces** el sistema guarda la configuración y devuelve `200 OK`.                                                                                                                                                         | EP-02 |

